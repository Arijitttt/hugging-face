import { HfInference,textGeneration } from "@huggingface/inference";
import dotenv from "dotenv";
import fetch from "node-fetch"; // Import node-fetch for making HTTP requests in Node.js

dotenv.config();

const HF_ACCESS_TOKEN = process.env.HF_ACCESS_TOKEN;

async function performInference() {
  const inference = new HfInference(HF_ACCESS_TOKEN);

  // const result =await hf.textToSpeech({
  //   model: 'espnet/kan-bayashi_ljspeech_vits',
  //   inputs: 'Hello world!'
  // })



  const model = "nlpconnect/vit-gpt2-image-captioning";
  const imageUrl =
    "data:image/jpeg;base64,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";

  // Fetch the image data
  const response = await fetch(imageUrl);
  const imageBlob = await response.blob(); // Use .buffer() to get the response body as a Buffer

  // Perform image to text inference
  const result = await inference.imageToText({
    data: imageBlob, // Pass the image data as a Buffer
    model: model,
  });

  console.log(result);

}

// Call the async function to perform the inference
performInference().catch((err) => {
  console.error("Error performing inference:", err);
});
